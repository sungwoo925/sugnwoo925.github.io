# 깃허브 블로그 만들기(2)

mdfiles 안에 게시글들을 마크다운 형식으로 넣었을 때 자동으로 html을 만들어주는 코드를 짜 보았다.
gh-pages를 활용해 배포라기 때문에 build파일안에 html파일들을 넣어 주어야한다.

```python
import os
import json
import re

def get_files_and_folders(directory):
    all_items = []
    for root, dirs, files in os.walk(directory):
        for name in files:
            file_path = os.path.join(root, name)
            all_items.append(("file", file_path))
    return all_items

def clean_folder(directory):
    if os.path.exists(directory):
        for filename in os.listdir(directory):
            if filename.endswith(".html") and filename != "index.html":
                file_path = os.path.join(directory, filename)
                try:
                    print(f"--{file_path}--")
                    if os.path.isfile(file_path):
                        os.remove(file_path)
                        print("파일이 삭제되었습니다.")
                    else:
                        print("는 파일이 아닙니다. 삭제할 수 없습니다.")
                except Exception as e:
                    print(f"파일 삭제 중 오류 발생: {e}")
        print(directory + "\nfolder clean")
        print("------------------------------")
    else:
        print("not found folder")

def post_html_files_save(directory,mdfiles): #html파일들을 만들어주는 함수
    if not os.path.exists(directory):
        os.makedirs(directory)
        print(f"{directory} 디렉토리가 생성되었습니다.")
    indexfile = ""
    with open(directory + '\\build\\index.html', 'r') as f:
        indexfile = f.read()
    notitleindex = indexfile.split("sungwoo's blog")

    with open(directory + '\\build\\' + 'about.html', 'w',encoding='utf-8') as f:
        f.write(indexfile)

    for post in mdfiles:
        post_name = post.split("\\")[-1].split(".md")[0].split("--")[1]
        savefile = notitleindex[0] + post_name + notitleindex[1]
        with open(directory + '\\build\\posts\\' + post_name + '.html', 'w',encoding='utf-8') as f:
            f.write(savefile)

    
    print("html files save complete")

def post_info_json_file_save(directory,mdfiles):
    # JSON 에 담기
    blogposts = {}
    blogposts['items'] = []
    blogposts['categories'] = []

    for mdfile in mdfiles:
        post = mdfile.split("\\")[-1].split(".md")[0].split("--")
        summary = ""
        with open(mdfile,'r',encoding='utf-8') as f:
            summary = re.sub(r'[^\w\s]', '', f.read()[:100].replace("\n", " ").replace("  ", " "))
        
        blogposts['items'].append(
            {
                'title': post[1],
                'date': post[0],
                'summary': summary,
                'dir': mdfile.split("build")[1]
            }
        )

    json_string = json.dumps(blogposts)

    # json파일로 정보 저장
    with open(directory + '\\build\\data.json', 'w',encoding='utf-8') as f:
        f.write(json_string)
    with open(directory + '\\public\\data.json', 'w',encoding='utf-8') as f:
        f.write(json_string)



current_directory = os.getcwd()  
items = get_files_and_folders(current_directory + "\\build\\mdfiles") 
dirs = []
for dir in items:
    dirs.append(dir[1])

clean_folder(current_directory + "\\build\\posts")
post_html_files_save(current_directory,dirs)
post_info_json_file_save(current_directory,dirs)
```

대충 이것저것 하다보니 만들어졌다.
원래 계획엔 없던 코드라 GPT를 활용해 대충 짜달라고 했다.